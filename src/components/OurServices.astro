---
import { getCollection } from 'astro:content';

const services = await getCollection('services');
const emergencyServices = services.filter(s => ['reboque-de-carros', 'reboque-de-motos', 'carga-de-bateria'].includes(s.slug));
const specializedServices = services.filter(s => ['caminhoes-e-pesados', 'pane-seca-e-pneus', 'atendimento-local'].includes(s.slug));

const zapLink = "https://wa.me/5521982769969?text=Ol%C3%A1%2C%20preciso%20de%20um%20reboque%20em%20Campo%20Grande.";

const getServiceIconPath = (slug: string) => {
  // Carro (Frontal/Tow)
  if (slug === 'reboque-de-carros') return 'M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z';
  
  // Moto 
  if (slug === 'reboque-de-motos') return 'M19,5C17.89,5 17,5.89 17,7A2,2 0 0,0 19,9A2,2 0 0,0 21,7C21,5.89 20.1,5 19,5M9,11L13.41,15.41C13.79,15.79 14.42,15.79 14.8,15.41L18.7,11.5L17.3,10.1L14.1,13.3L12.5,11.7L15,8H13L9,11M5,11L8,12L10,8.5L8.5,7.7L5,11M5,13C2.24,13 0,15.24 0,18A5,5 0 0,0 5,23C7.76,23 10,20.76 10,18C10,15.24 7.76,13 5,13M5,21A3,3 0 0,1 2,18C2,16.34 3.34,15 5,15C6.66,15 8,16.34 8,18A3,3 0 0,1 5,21M19,13C16.24,13 14,15.24 14,18A5,5 0 0,0 19,23C21.76,23 24,20.76 24,18C24,15.24 21.76,13 19,13M19,21A3,3 0 0,1 16,18C16,16.34 17.34,15 19,15C20.66,15 22,16.34 22,18A3,3 0 0,1 19,21Z';
  
  // Bateria (Lightning/Battery)
  if (slug === 'carga-de-bateria') return 'M13 2L3 14h9l-1 8 10-12h-9l1-8z';
  
  // Caminhão (Truck)
  if (slug === 'caminhoes-e-pesados') return 'M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z';
  
  // Pneu/Fuel (Wrench/Drop)
  if (slug === 'pane-seca-e-pneus') return 'M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.04.17 0 .36.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.04-.17 0-.36-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z';
  
  // Local (Map Pin)
  if (slug === 'atendimento-local') return 'M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z';
  
  // Default Bolt
  return 'M13 2L3 14h9l-1 8 10-12h-9l1-8z';
};
---

<section id="services" class="services-redesign py-24 bg-[#0a0a0a]">
  <div class="container mx-auto px-4">
    <div class="section-header text-center mb-16">
      <h2 class="text-gradient text-4xl md:text-5xl font-extrabold mb-4">Socorro Imediato em Campo Grande</h2>
      <p class="text-gray-400 text-lg max-w-xl mx-auto">Precisa de ajuda agora? A Juniauto é sua base de apoio 24h na Zona Oeste.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-20">
      {emergencyServices.map((service) => (
        <a href={`/servicos/${service.slug}`} class="service-link-wrapper no-underline group">
          <div class="service-card glass-card p-10 h-full flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-2 hover:border-[#ffd600]/30">
            <div class="icon-box w-16 h-16 bg-[#ffd600]/10 rounded-2xl flex items-center justify-center mb-6 text-[#ffd600] group-hover:bg-[#ffd600] group-hover:text-black transition-colors">
               <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d={getServiceIconPath(service.slug)}></path></svg>
            </div>
            <h3 class="text-white text-2xl font-bold mb-4">{service.data.shortTitle}</h3>
            <p class="text-gray-400 leading-relaxed mb-6 flex-grow">{service.data.description}</p>
            <span class="learn-more text-[#ffd600] text-sm font-black uppercase tracking-widest group-hover:translate-x-1 transition-transform inline-flex items-center gap-2">
              Saiba mais →
            </span>
          </div>
        </a>
      ))}
    </div>

    <div class="section-header text-center mb-16 mt-32">
      <h2 class="text-gradient text-4xl md:text-5xl font-extrabold mb-4">Serviços Especializados</h2>
      <p class="text-gray-400 text-lg max-w-xl mx-auto">Logística pesada e apoio em situações complexas com técnica e autoridade.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {specializedServices.map((service) => (
        <a href={`/servicos/${service.slug}`} class="service-link-wrapper no-underline group">
          <div class="service-card glass-card p-10 h-full flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-2 hover:border-[#ffd600]/30">
            <div class="icon-box w-16 h-16 bg-[#ffd600]/10 rounded-2xl flex items-center justify-center mb-6 text-[#ffd600] group-hover:bg-[#ffd600] group-hover:text-black transition-colors">
               <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d={getServiceIconPath(service.slug)}></path></svg>
            </div>
            <h3 class="text-white text-2xl font-bold mb-4">{service.data.shortTitle}</h3>
            <p class="text-gray-400 leading-relaxed mb-6 flex-grow">{service.data.description}</p>
            <span class="learn-more text-[#ffd600] text-sm font-black uppercase tracking-widest group-hover:translate-x-1 transition-transform inline-flex items-center gap-2">
              Saiba mais →
            </span>
          </div>
        </a>
      ))}
    </div>
  </div>
</section>

<style>
  .text-gradient {
    background: linear-gradient(90deg, #fff 0%, #ffd600 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
</style>
