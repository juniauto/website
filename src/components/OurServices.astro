---
import { getCollection } from 'astro:content';

const services = await getCollection('services');
const emergencyServices = services.filter(s => ['reboque-de-carros', 'reboque-de-motos', 'carga-de-bateria'].includes(s.slug));
const specializedServices = services.filter(s => ['caminhoes-e-pesados', 'pane-seca-e-pneus', 'atendimento-local'].includes(s.slug));

const zapLink = "https://wa.me/5521982769969?text=Ol%C3%A1%2C%20preciso%20de%20um%20reboque%20em%20Campo%20Grande.";

const getServiceIconPath = (slug: string) => {
  // Carro (Frontal/Tow)
  if (slug === 'reboque-de-carros') return 'M19 19H5V8h14m-3-7v2H8V1H5v2H2v19h20V3h-3V1m-3.45 4.5h-5.1v1.5h5.1M12 11.5a2.5 2.5 0 00-2.5 2.5 2.5 2.5 0 002.5 2.5 2.5 2.5 0 002.5-2.5 2.5 2.5 0 00-2.5-2.5';
  
  // Moto 
  if (slug === 'reboque-de-motos') return 'M19.98 12.3c-1.38-2.61-3.66-3.8-6.18-4.1l-2.07-2.62c2.19.86 3.65 2.97 3.65 5.4 0 3.2-2.58 5.79-5.78 5.79-3.2 0-5.78-2.57-5.78-5.77 0-1.28.43-2.47 1.15-3.43l3.22 4.09h1.72l1.64 2.1c1.32-.47 2.45-1.31 3.26-2.41-.6-.28-1.57-.45-2.88-1.05h.05c-1.4.32-2.9.22-4.22-.3l-.88-1.11c-.02.46-.02.93.03 1.41.03.4.1.8.2 1.19l-4.59-5.83.08-.06c.41-1.29 1.46-2.3 2.76-2.67.24-.65.23-.7.5-.67.27.03 1.34 1.12 1.34 1.12l4.63.48c.96.11 1.76.69 2.19 1.54l1.63 2.07c2.11.23 4.14 1.25 5.48 3.51.13.23.06.52-.16.65-.24.13-.53.05-.66-.18M9.6 14.97c-2.1 0-3.79-1.69-3.79-3.77 0-.3.06-.6.13-.87l4.53 5.76V16h-5.4l-.87-1.1zm9.9 5.5l-3.2-3.8c1.3.4 2.1 1.6 2.1 3-1.6 0-2.9-1.3-2.9-2.9 0-.4.1-.8.2-1.2l-4.1-4.9-3.2 2.6c.1.9.4 1.8 1 2.5 1.7 2.1 4.7 2.4 6.8.7l2.8 3.4c.1.1.3.2.4.2.2 0 .4-.1.5-.2.2-.2.2-.5.0-.6';
  
  // Bateria (Lightning/Battery)
  if (slug === 'carga-de-bateria') return 'M13 2L3 14h9l-1 8 10-12h-9l1-8z';
  
  // Caminhão (Truck)
  if (slug === 'caminhoes-e-pesados') return 'M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z';
  
  // Pneu/Fuel (Wrench/Drop)
  if (slug === 'pane-seca-e-pneus') return 'M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.04.17 0 .36.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.04-.17 0-.36-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z';
  
  // Local (Map Pin)
  if (slug === 'atendimento-local') return 'M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z';
  
  // Default Bolt
  return 'M13 2L3 14h9l-1 8 10-12h-9l1-8z';
};
---

<section id="services" class="services-redesign py-24 bg-[#0a0a0a]">
  <div class="container mx-auto px-4">
    <div class="section-header text-center mb-16">
      <h2 class="text-gradient text-4xl md:text-5xl font-extrabold mb-4">Socorro Imediato em Campo Grande</h2>
      <p class="text-gray-400 text-lg max-w-xl mx-auto">Precisa de ajuda agora? A Juniauto é sua base de apoio 24h na Zona Oeste.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-20">
      {emergencyServices.map((service) => (
        <a href={`/servicos/${service.slug}`} class="service-link-wrapper no-underline group">
          <div class="service-card glass-card p-10 h-full flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-2 hover:border-[#ffd600]/30">
            <div class="icon-box w-16 h-16 bg-[#ffd600]/10 rounded-2xl flex items-center justify-center mb-6 text-[#ffd600] group-hover:bg-[#ffd600] group-hover:text-black transition-colors">
               <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d={getServiceIconPath(service.slug)}></path></svg>
            </div>
            <h3 class="text-white text-2xl font-bold mb-4">{service.data.shortTitle}</h3>
            <p class="text-gray-400 leading-relaxed mb-6 flex-grow">{service.data.description}</p>
            <span class="learn-more text-[#ffd600] text-sm font-black uppercase tracking-widest group-hover:translate-x-1 transition-transform inline-flex items-center gap-2">
              Saiba mais →
            </span>
          </div>
        </a>
      ))}
    </div>

    <div class="section-header text-center mb-16 mt-32">
      <h2 class="text-gradient text-4xl md:text-5xl font-extrabold mb-4">Serviços Especializados</h2>
      <p class="text-gray-400 text-lg max-w-xl mx-auto">Logística pesada e apoio em situações complexas com técnica e autoridade.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {specializedServices.map((service) => (
        <a href={`/servicos/${service.slug}`} class="service-link-wrapper no-underline group">
          <div class="service-card glass-card p-10 h-full flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-2 hover:border-[#ffd600]/30">
            <div class="icon-box w-16 h-16 bg-[#ffd600]/10 rounded-2xl flex items-center justify-center mb-6 text-[#ffd600] group-hover:bg-[#ffd600] group-hover:text-black transition-colors">
               <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d={getServiceIconPath(service.slug)}></path></svg>
            </div>
            <h3 class="text-white text-2xl font-bold mb-4">{service.data.shortTitle}</h3>
            <p class="text-gray-400 leading-relaxed mb-6 flex-grow">{service.data.description}</p>
            <span class="learn-more text-[#ffd600] text-sm font-black uppercase tracking-widest group-hover:translate-x-1 transition-transform inline-flex items-center gap-2">
              Saiba mais →
            </span>
          </div>
        </a>
      ))}
    </div>
  </div>
</section>

<style>
  .text-gradient {
    background: linear-gradient(90deg, #fff 0%, #ffd600 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
</style>
